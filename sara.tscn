[gd_scene load_steps=7 format=3]

[sub_resource type="CapsuleMesh" id="CapsuleMesh_sara"]
radius = 0.5
height = 2.0

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_sara"]
radius = 0.5
height = 2.0

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_sara"]
albedo_color = Color(0.2, 0.6, 1, 1)

[sub_resource type="Environment" id="Environment_sara"]
background_mode = 1
background_color = Color(0.1, 0.1, 0.15, 1)
ambient_light_source = 2
ambient_light_color = Color(0.3, 0.3, 0.4, 1)
ambient_light_energy = 0.5
tonemap_mode = 2
glow_enabled = true
glow_intensity = 0.5

[sub_resource type="GDScript" id="GDScript_sara"]
script/source = "extends CharacterBody3D\n\n## Velocidad de movimiento\n@export var move_speed: float = 5.0\n## Velocidad de rotación\n@export var rotation_speed: float = 4.0\n## Velocidad de la cámara (mouse)\n@export var mouse_sensitivity: float = 0.003\n\n## Referencia a la cámara\n@onready var camera: Camera3D = $Camera3D\n\nfunc _ready() -> void:\n\t# Capturar el mouse para controlar la cámara\n\tInput.set_mouse_mode(Input.MOUSE_MODE_CAPTURED)\n\nfunc _input(event: InputEvent) -> void:\n\t# Soltar el mouse con ESC\n\tif event.is_action_pressed(\"ui_cancel\"):\n\t\tif Input.get_mouse_mode() == Input.MOUSE_MODE_CAPTURED:\n\t\t\tInput.set_mouse_mode(Input.MOUSE_MODE_VISIBLE)\n\t\telse:\n\t\t\tInput.set_mouse_mode(Input.MOUSE_MODE_CAPTURED)\n\t\n\t# Rotar cámara con el mouse\n\tif event is InputEventMouseMotion and Input.get_mouse_mode() == Input.MOUSE_MODE_CAPTURED:\n\t\trotate_y(-event.relative.x * mouse_sensitivity)\n\t\tcamera.rotate_x(-event.relative.y * mouse_sensitivity)\n\t\tcamera.rotation.x = clamp(camera.rotation.x, deg_to_rad(-80), deg_to_rad(80))\n\nfunc _physics_process(delta: float) -> void:\n\t# Obtener dirección con WASD\n\tvar input_dir := Vector3.ZERO\n\t\n\tif Input.is_key_pressed(KEY_W):\n\t\tinput_dir.z -= 1\n\tif Input.is_key_pressed(KEY_S):\n\t\tinput_dir.z += 1\n\tif Input.is_key_pressed(KEY_A):\n\t\tinput_dir.x -= 1\n\tif Input.is_key_pressed(KEY_D):\n\t\tinput_dir.x += 1\n\t\n\t# Calcular la dirección del movimiento relativa a la cámara\n\tvar direction := (transform.basis * input_dir).normalized()\n\t\n\t# Aplicar movimiento\n\tif direction:\n\t\tvelocity.x = direction.x * move_speed\n\t\tvelocity.z = direction.z * move_speed\n\telse:\n\t\t# Fricción - detener gradualmente\n\t\tvelocity.x = move_toward(velocity.x, 0, move_speed)\n\t\tvelocity.z = move_toward(velocity.z, 0, move_speed)\n\t\n\t# Mover el personaje\n\tmove_and_slide()\n\n\t# Rotar el personaje hacia la dirección del movimiento\n\tif direction:\n\t\tvar target_rotation := atan2(direction.x, direction.z)\n\t\tvar current_rotation := rotation.y\n\t\trotation.y = lerp_angle(current_rotation, target_rotation, rotation_speed * delta)\n"

[node name="Sara" type="CharacterBody3D"]
script = SubResource("GDScript_sara")

[node name="MeshInstance3D" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
mesh = SubResource("CapsuleMesh_sara")
surface_material_override/0 = SubResource("StandardMaterial3D_sara")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_sara")

[node name="Camera3D" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.866025, 0.5, 0, -0.5, 0.866025, 0, 3, 4)
current = true
fov = 70.0

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.866025, -0.353553, 0.353553, 0, 0.707107, 0.707107, -0.5, -0.612372, 0.612372, 0, 5, 0)
light_color = Color(1, 0.95, 0.9, 1)
light_energy = 1.2
shadow_enabled = true

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_sara")

[node name="DirectionalLight3D2" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.866025, 0.25, -0.433013, 0, 0.866025, 0.5, 0.5, -0.433013, 0.75, 0, 3, 0)
light_color = Color(0.6, 0.7, 1, 1)
light_energy = 0.5
